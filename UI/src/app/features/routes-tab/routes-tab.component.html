<div class="flex flex-col gap-6">
  <div class="grid gap-3 md:grid-cols-2 xl:grid-cols-3">
    <mat-card
      *ngFor="let route of routes"
      class="route-card cursor-pointer border border-transparent transition-all"
      [class.opacity-40]="!isActive(route)"
      (mouseenter)="handleHover(route.vehicle)"
      (mouseleave)="handleHover(null)"
    >
      <div class="flex items-center justify-between">
        <div>
          <div class="text-xs uppercase tracking-wide text-slate-500">Vehicle {{ route.vehicle }}</div>
          <div class="text-lg font-semibold text-slate-800">{{ route.distance | number: '1.2-2' }} km</div>
        </div>
        <mat-icon class="text-2xl" [style.color]="route.color || '#3b82f6'">timeline</mat-icon>
      </div>
      <div class="mt-3 flex flex-wrap items-center gap-2 text-xs text-slate-500">
        <span class="rounded-full bg-slate-100 px-2 py-1">Load {{ route.load }}</span>
        <span class="rounded-full bg-slate-100 px-2 py-1">Stops {{ route.nodes.length - 2 }}</span>
      </div>
      <div class="mt-3 text-xs text-slate-500">
        Customers: {{ getCustomersLabel(route) || '—' }}
      </div>
    </mat-card>
  </div>

  <div class="overflow-auto">
    <table mat-table [dataSource]="routes" class="w-full min-w-[480px]">
      <ng-container matColumnDef="vehicle">
        <th mat-header-cell *matHeaderCellDef>Vehicle</th>
        <td mat-cell *matCellDef="let route" [class.text-blue-600]="isActive(route)">
          {{ route.vehicle }}
        </td>
      </ng-container>

      <ng-container matColumnDef="distance">
        <th mat-header-cell *matHeaderCellDef>Distance (km)</th>
        <td mat-cell *matCellDef="let route">{{ route.distance | number: '1.2-2' }}</td>
      </ng-container>

      <ng-container matColumnDef="load">
        <th mat-header-cell *matHeaderCellDef>Load</th>
        <td mat-cell *matCellDef="let route">{{ route.load }}</td>
      </ng-container>

      <ng-container matColumnDef="customers">
        <th mat-header-cell *matHeaderCellDef>Customers</th>
        <td mat-cell *matCellDef="let route">{{ getCustomersLabel(route) || '—' }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        (mouseenter)="handleHover(row.vehicle)"
        (mouseleave)="handleHover(null)"
        [class.bg-blue-50]="isActive(row)"
      ></tr>
    </table>
  </div>
</div>
